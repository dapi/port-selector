# port-selector

[![CI](https://github.com/dapi/port-selector/actions/workflows/ci.yml/badge.svg)](https://github.com/dapi/port-selector/actions/workflows/ci.yml)
[![Release](https://github.com/dapi/port-selector/actions/workflows/release.yml/badge.svg)](https://github.com/dapi/port-selector/actions/workflows/release.yml)
[![Go Report Card](https://goreportcard.com/badge/github.com/dapi/port-selector)](https://goreportcard.com/report/github.com/dapi/port-selector)
[![Parallel AI Agents](https://img.shields.io/badge/Parallel_AI-Agents_Ready-00d4aa)](https://github.com/dapi/port-selector)

[๐ฌ๐ง English version](README.md)

CLI ััะธะปะธัะฐ ะดะปั ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ะฒัะฑะพัะฐ ัะฒะพะฑะพะดะฝะพะณะพ ะฟะพััะฐ ะธะท ะทะฐะดะฐะฝะฝะพะณะพ ะดะธะฐะฟะฐะทะพะฝะฐ.

## ะะพัะธะฒะฐัะธั

ะัะธ ัะฐะทัะฐะฑะพัะบะต ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ AI-ะฐะณะตะฝัะพะฒ (Claude Code, Cursor, Copilot Workspace ะธ ะดั.) ัะฐััะพ ะฒะพะทะฝะธะบะฐะตั ัะธััะฐัะธั, ะบะพะณะดะฐ ะผะฝะพะถะตััะฒะพ ะฟะฐัะฐะปะปะตะปัะฝัั ะฐะณะตะฝัะพะฒ ัะฐะฑะพัะฐัั ะฝะฐะด ะทะฐะดะฐัะฐะผะธ ะฒ ะพัะดะตะปัะฝัั git worktree. ะะฐะถะดัะน ะฐะณะตะฝั ะผะพะถะตั ะทะฐะฟััะบะฐัั ะฒะตะฑ-ัะตัะฒะตัั ะดะปั e2e-ัะตััะธัะพะฒะฐะฝะธั, ะธ ะฒัะตะผ ะธะผ ะฝัะถะฝั ัะฒะพะฑะพะดะฝัะต ะฟะพััั.

**ะัะพะฑะปะตะผะฐ:** ะะพะณะดะฐ 5-10 ะฐะณะตะฝัะพะฒ ะพะดะฝะพะฒัะตะผะตะฝะฝะพ ะฟััะฐัััั ะทะฐะฟัััะธัั dev-ัะตัะฒะตัั ะฝะฐ ะฟะพััั 3000, ะฒะพะทะฝะธะบะฐัั ะบะพะฝัะปะธะบัั.

**ะะตัะตะฝะธะต:** `port-selector` ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฝะฐัะพะดะธั ะธ ะฒัะดะฐัั ะฟะตัะฒัะน ัะฒะพะฑะพะดะฝัะน ะฟะพัั ะธะท ะฝะฐัััะพะตะฝะฝะพะณะพ ะดะธะฐะฟะฐะทะพะฝะฐ.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Agent 1 (worktree: feature-auth)                           โ
โ  $ PORT=$(port-selector) && npm run dev -- --port $PORT     โ
โ  โ Server running on http://localhost:3000                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  Agent 2 (worktree: feature-dashboard)                      โ
โ  $ PORT=$(port-selector) && npm run dev -- --port $PORT     โ
โ  โ Server running on http://localhost:3001                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  Agent 3 (worktree: bugfix-login)                           โ
โ  $ PORT=$(port-selector) && npm run dev -- --port $PORT     โ
โ  โ Server running on http://localhost:3002                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะผะฐัะตัะธะฐะปั

ะัะฐะบัะธะบะฐ ะทะฐะฟััะบะฐ ะฝะตัะบะพะปัะบะธั AI-ะฐะณะตะฝัะพะฒ ะฟะฐัะฐะปะปะตะปัะฝะพ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ git worktrees ััะฐะฝะพะฒะธััั ะฒัั ะฑะพะปะตะต ะฟะพะฟัะปััะฝะพะน. ะะฐะถะดัะน worktree ะพะฑะตัะฟะตัะธะฒะฐะตั ะฟะพะปะฝัั ะธะทะพะปััะธั ัะฐะนะปะพะฒ, ะฝะพ ะฒัะต ะฐะณะตะฝัั ะฟะพ-ะฟัะตะถะฝะตะผั ะธัะฟะพะปัะทััั ะพะฑัะธะต ัะตัะตะฒัะต ัะตััััั โ ะฒะบะปััะฐั ะฟะพััั. ะะพะณะดะฐ ะฐะณะตะฝัั ะทะฐะฟััะบะฐัั dev-ัะตัะฒะตัั, e2e-ัะตััั ะธะปะธ preview-ะดะตะฟะปะพะนะผะตะฝัั, ะบะพะฝัะปะธะบัั ะฟะพััะพะฒ ะฝะตะธะทะฑะตะถะฝั.

`port-selector` ัะตัะฐะตั ััั ะฟัะพะฑะปะตะผั, ะพะฑะตัะฟะตัะธะฒะฐั ะฐะฒัะพะผะฐัะธัะตัะบะพะต ะฒัะดะตะปะตะฝะธะต ะฟะพััะพะฒ ั ะฟะตัะธะพะดะพะผ ะทะฐะผะพัะพะทะบะธ โ ะบะฐะถะดัะน ะฐะณะตะฝั ะฟะพะปััะฐะตั ัะฝะธะบะฐะปัะฝัะน ะฟะพัั, ะดะฐะถะต ะตัะปะธ ะฝะตัะบะพะปัะบะพ ะฐะณะตะฝัะพะฒ ััะฐััััั ะพะดะฝะพะฒัะตะผะตะฝะฝะพ.

**ะกัะฐััะธ ะพ ะฟะฐัะฐะปะปะตะปัะฝะพะน ัะฐะทัะฐะฑะพัะบะต ั AI-ะฐะณะตะฝัะฐะผะธ:**

- [How we're shipping faster with Claude Code and Git Worktrees](https://incident.io/blog/shipping-faster-with-claude-code-and-git-worktrees) โ ะพะฟัั incident.io ั ะฝะตัะบะพะปัะบะธะผะธ ัะตััะธัะผะธ Claude Code ะธ ะบะฐััะพะผะฝัะผ ะผะตะฝะตะดะถะตัะพะผ worktree
- [Parallel AI Development with Git Worktrees](https://sgryt.com/posts/git-worktree-parallel-ai-development/) โ ยซััะธ ััะพะปะฟะฐยป: ะธะทะพะปััะธั ัะพััะพัะฝะธั, ะฟะฐัะฐะปะปะตะปัะฝะพะต ะฒัะฟะพะปะฝะตะฝะธะต, ะฐัะธะฝััะพะฝะฝะฐั ะธะฝัะตะณัะฐัะธั
- [How Git Worktrees Changed My AI Agent Workflow](https://nx.dev/blog/git-worktrees-ai-agents) โ ะฟัะฐะบัะธัะตัะบะธะต ััะตะฝะฐัะธะธ, ะบะพะณะดะฐ ะฐะณะตะฝัั ัะฐะฑะพัะฐัั ะฒ ัะพะฝะต, ะฟะพะบะฐ ะฒั ะฟัะพะดะพะปะถะฐะตัะต ะบะพะดะธัั
- [Git Worktrees: The Secret Weapon for Running Multiple AI Agents](https://medium.com/@mabd.dev/git-worktrees-the-secret-weapon-for-running-multiple-ai-coding-agents-in-parallel-e9046451eb96) โ ะฟะพัะตะผั worktrees ััะฐะปะธ ะฝะตะพะฑัะพะดะธะผั ะฒ ัะฟะพัั AI-ัะฐะทัะฐะฑะพัะบะธ
- [Parallel Coding Agents with Container Use and Git Worktree](https://www.youtube.com/watch?v=z1osqcNQRvw) โ ะฒะธะดะตะพ-ะพะฑะทะพั ัััั workflow ะดะปั ะฟะฐัะฐะปะปะตะปัะฝัั ะฐะณะตะฝัะพะฒ

## ะฃััะฐะฝะพะฒะบะฐ

### ะะท ัะตะปะธะทะพะฒ GitHub

```bash
# Linux (amd64)
curl -L https://github.com/dapi/port-selector/releases/latest/download/port-selector-linux-amd64 -o port-selector
chmod +x port-selector
sudo mv port-selector /usr/local/bin/

# macOS (arm64 - Apple Silicon)
curl -L https://github.com/dapi/port-selector/releases/latest/download/port-selector-darwin-arm64 -o port-selector
chmod +x port-selector
sudo mv port-selector /usr/local/bin/

# macOS (amd64 - Intel)
curl -L https://github.com/dapi/port-selector/releases/latest/download/port-selector-darwin-amd64 -o port-selector
chmod +x port-selector
sudo mv port-selector /usr/local/bin/
```

### ะกะฑะพัะบะฐ ะธะท ะธััะพะดะฝะธะบะพะฒ

```bash
git clone https://github.com/dapi/port-selector.git
cd port-selector
make install
```

ะญัะพ ัะพะฑะตััั ะฑะธะฝะฐัะฝะธะบ ะธ ัััะฐะฝะพะฒะธั ะตะณะพ ะฒ `/usr/local/bin/`.

## ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ะะฐะทะพะฒะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต

```bash
# ะะพะปััะธัั ัะฒะพะฑะพะดะฝัะน ะฟะพัั
port-selector
# ะัะฒะพะด: 3000

# ะัะฟะพะปัะทะพะฒะฐัั ะฒ ัะบัะธะฟัะต
PORT=$(port-selector)
npm run dev -- --port $PORT

# ะะปะธ ะฒ ะพะดะฝั ัััะพะบั
npm run dev -- --port $(port-selector)
```

### ะัะธะผะตัั ะธะฝัะตะณัะฐัะธะธ

#### Next.js / Vite / ะปัะฑะพะน dev-ัะตัะฒะตั

```bash
# package.json scripts
{
  "scripts": {
    "dev": "PORT=$(port-selector) next dev -p $PORT",
    "dev:vite": "vite --port $(port-selector)"
  }
}
```

#### Docker Compose

```bash
# ะ .env ะธะปะธ ะฟัะธ ะทะฐะฟััะบะต
export APP_PORT=$(port-selector)
docker-compose up
```

#### Playwright / e2e ัะตััั

```bash
# ะ ะบะพะฝัะธะณะต playwright
export BASE_URL="http://localhost:$(port-selector)"
npx playwright test
```

#### direnv (.envrc)

ะะดะตะฐะปัะฝัะน ัะฟะพัะพะฑ ะดะปั ะฟัะพะตะบัะพะฒ ั git worktree โ ะฟะพัั ะฝะฐะทะฝะฐัะฐะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะธ ะฒัะพะดะต ะฒ ะดะธัะตะบัะพัะธั:

```bash
# .envrc
export PORT=$(port-selector)

# ะขะตะฟะตัั ะฒ ะปัะฑะพะผ ัะบัะธะฟัะต ะฟัะพะตะบัะฐ ะธัะฟะพะปัะทัะนัะต $PORT
# npm run dev ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟะพะปััะธั ัะฒะพะน ัะฝะธะบะฐะปัะฝัะน ะฟะพัั
```

```bash
# ะัะธะผะตั workflow ั git worktree
$ cd ~/projects/myapp-feature-auth
direnv: loading .envrc
direnv: export +PORT

$ echo $PORT
3000

$ cd ~/projects/myapp-feature-dashboard
direnv: loading .envrc
direnv: export +PORT

$ echo $PORT
3001
```

#### Claude Code / AI ะฐะณะตะฝัั

ะะพะฑะฐะฒััะต ะฒ CLAUDE.md ะฒะฐัะตะณะพ ะฟัะพะตะบัะฐ:

```markdown
## ะะฐะฟััะบ dev-ัะตัะฒะตัะฐ

ะะตัะตะด ะทะฐะฟััะบะพะผ dev-ัะตัะฒะตัะฐ ะฒัะตะณะดะฐ ะธัะฟะพะปัะทัะน port-selector:
\`\`\`bash
PORT=$(port-selector) npm run dev -- --port $PORT
\`\`\`
```

### ะัะธะฒัะทะบะฐ ะฟะพััะฐ ะบ ะดะธัะตะบัะพัะธะธ

ะะฐะถะดะฐั ะดะธัะตะบัะพัะธั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟะพะปััะฐะตั ัะฒะพะน ะฒัะดะตะปะตะฝะฝัะน ะฟะพัั. ะะฐะฟััะบ `port-selector` ะธะท ะพะดะฝะพะน ะดะธัะตะบัะพัะธะธ ะฒัะตะณะดะฐ ะฒะพะทะฒัะฐัะฐะตั ะพะดะธะฝ ะธ ัะพั ะถะต ะฟะพัั:

```bash
$ cd ~/projects/project-a
$ port-selector
3000

$ cd ~/projects/project-b
$ port-selector
3001

$ cd ~/projects/project-a
$ port-selector
3000  # ะขะพั ะถะต ะฟะพัั!
```

ะัะพะฑะตะฝะฝะพ ะฟะพะปะตะทะฝะพ ั git worktree โ ะบะฐะถะดัะน worktree ะฟะพะปััะฐะตั ััะฐะฑะธะปัะฝัะน ะฟะพัั.

### ะฃะฟัะฐะฒะปะตะฝะธะต ะฐะปะปะพะบะฐัะธัะผะธ

```bash
# ะะพะบะฐะทะฐัั ะฒัะต ะฐะปะปะพะบะฐัะธะธ ะฟะพััะพะฒ
port-selector --list

# ะัะฒะพะด:
# PORT  STATUS  LOCKED  USER   PID    PROCESS  DIRECTORY                    ASSIGNED
# 3000  free            -      -      -        /home/user/projects/app-a    2025-01-02 10:30
# 3001  busy    yes     user   12345  node     /home/user/projects/app-b    2025-01-02 11:45
# 3007  busy            root   -      -        (unknown:3007)               2025-01-02 12:00
#
# ะกะพะฒะตั: ะะฐะฟัััะธัะต ั sudo ะดะปั ะฟะพะปะฝะพะน ะธะฝัะพัะผะฐัะธะธ ะพ ะฟัะพัะตััะฐั: sudo port-selector --list

# ะฃะดะฐะปะธัั ะฐะปะปะพะบะฐัะธั ะดะปั ัะตะบััะตะน ะดะธัะตะบัะพัะธะธ
cd ~/projects/old-project
port-selector --forget
# Cleared allocation for /home/user/projects/old-project (was port 3005)

# ะฃะดะฐะปะธัั ะฒัะต ะฐะปะปะพะบะฐัะธะธ
port-selector --forget-all
# Cleared 5 allocation(s)
```

#### ะะฐะฟััะบ ัะตัะตะท sudo

ะงัะพะฑั ะฒะธะดะตัั ะฟะพะปะฝัั ะธะฝัะพัะผะฐัะธั ะพ ะฟัะพัะตััะฐั (PID, ะธะผั ะฟัะพัะตััะฐ) ะดะปั ะฟะพััะพะฒ, ะฟัะธะฝะฐะดะปะตะถะฐัะธั ะดััะณะธะผ ะฟะพะปัะทะพะฒะฐัะตะปัะผ, ะทะฐะฟััะบะฐะนัะต ัะตัะตะท sudo. **ะะฐะถะฝะพ:** ะธัะฟะพะปัะทัะนัะต ัะปะฐะณ `-E` ะดะปั ัะพััะฐะฝะตะฝะธั ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั, ะธะฝะฐัะต ะบะพะฝัะธะณ ะฑัะดะตั ัะพะทะดะฐะฝ ะฒ `/root/.config/`:

```bash
# ะะตะฟัะฐะฒะธะปัะฝะพ: ัะพะทะดะฐัั ะพัะดะตะปัะฝัะน ะบะพะฝัะธะณ ะฒ /root/.config/port-selector/
sudo port-selector --list

# ะัะฐะฒะธะปัะฝะพ: ะธัะฟะพะปัะทัะตั ะบะพะฝัะธะณ ะฒะฐัะตะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั
sudo -E port-selector --list

# ะะปััะตัะฝะฐัะธะฒะฐ: ัะฒะฝะพ ะฟะตัะตะดะฐัั HOME
sudo HOME=$HOME port-selector --list
```

### ะะปะพะบะธัะพะฒะบะฐ ะฟะพััะพะฒ

ะะฐะฑะปะพะบะธััะนัะต ะฟะพัั, ััะพะฑั ะพะฝ ะฝะต ะผะพะณ ะฑััั ะฒัะดะตะปะตะฝ ะดััะณะธะผ ะดะธัะตะบัะพัะธัะผ. ะะพะปะตะทะฝะพ ะดะปั ะดะพะปะณะพะถะธะฒััะธั ัะตัะฒะธัะพะฒ, ะบะพัะพััะผ ะฝัะถะฝะพ ัะพััะฐะฝััั ัะฒะพะน ะฟะพัั ะดะฐะถะต ะฟัะธ ะฟะตัะตะทะฐะฟััะบะต:

```bash
# ะะฐะฑะปะพะบะธัะพะฒะฐัั ะฟะพัั ะดะปั ัะตะบััะตะน ะดะธัะตะบัะพัะธะธ
cd ~/projects/my-service
port-selector --lock
# Locked port 3000

# ะะฐะฑะปะพะบะธัะพะฒะฐัั ะบะพะฝะบัะตัะฝัะน ะฟะพัั (ะฒัะดะตะปัะตั ะ ะฑะปะพะบะธััะตั ะทะฐ ะพะดะธะฝ ัะฐะณ)
cd ~/projects/new-service
port-selector --lock 3005
# Locked port 3005

# ะะฐะทะฑะปะพะบะธัะพะฒะฐัั ะฟะพัั ะดะปั ัะตะบััะตะน ะดะธัะตะบัะพัะธะธ
port-selector --unlock
# Unlocked port 3000

# ะะฐะทะฑะปะพะบะธัะพะฒะฐัั ะบะพะฝะบัะตัะฝัะน ะฟะพัั
port-selector --unlock 3005
# Unlocked port 3005
```

ะัะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธะธ `--lock <PORT>` ั ะบะพะฝะบัะตัะฝัะผ ะฝะพะผะตัะพะผ ะฟะพััะฐ:
- ะัะปะธ ะฟะพัั ะฝะต ะฒัะดะตะปะตะฝ, ะพะฝ ะฑัะดะตั ะฒัะดะตะปะตะฝ ัะตะบััะตะน ะดะธัะตะบัะพัะธะธ ะ ะทะฐะฑะปะพะบะธัะพะฒะฐะฝ
- ะญัะพ ัะดะพะฑะฝะพ, ะบะพะณะดะฐ ะฒั ัะพัะธัะต ะบะพะฝะบัะตัะฝัะน ะฟะพัั ะดะปั ะฝะพะฒะพะณะพ ะฟัะพะตะบัะฐ
- ะะพัั ะดะพะปะถะตะฝ ะฑััั ัะฒะพะฑะพะดะตะฝ ะธ ะฝะฐัะพะดะธัััั ะฒ ะฝะฐัััะพะตะฝะฝะพะผ ะดะธะฐะฟะฐะทะพะฝะต

ะะพะณะดะฐ ะฟะพัั ะทะฐะฑะปะพะบะธัะพะฒะฐะฝ:
- ะะฝ ะพััะฐัััั ะทะฐะบัะตะฟะปัะฝะฝัะผ ะทะฐ ัะฒะพะตะน ะดะธัะตะบัะพัะธะตะน
- ะััะณะธะต ะดะธัะตะบัะพัะธะธ ะฝะต ะผะพะณัั ะฟะพะปััะธัั ััะพั ะฟะพัั ะฟัะธ ะฒัะดะตะปะตะฝะธะธ
- ะะปะฐะดะตััะฐั ะดะธัะตะบัะพัะธั ะผะพะถะตั ะธัะฟะพะปัะทะพะฒะฐัั ะฟะพัั ะบะฐะบ ะพะฑััะฝะพ

### ะะฑะฝะฐััะถะตะฝะธะต ัััะตััะฒัััะธั ะฟะพััะพะฒ

ะัะธ ะฟะตัะฒะพะผ ะธัะฟะพะปัะทะพะฒะฐะฝะธะธ `port-selector` ะฒ ะพะบััะถะตะฝะธะธ, ะณะดะต ัะฐััั ะฟะพััะพะฒ ัะถะต ะทะฐะฝััะฐ, ะผะพะถะฝะพ ะฟัะพัะบะฐะฝะธัะพะฒะฐัั ะดะธะฐะฟะฐะทะพะฝ ะธ ะทะฐะฟะธัะฐัั ะธั:

```bash
port-selector --scan
# Scanning ports 3000-4000...
# Port 3000: used by node (pid=12345, cwd=/home/user/project-a)
# Port 3001: used by ruby (pid=12346, cwd=/home/user/project-b)
# Port 3005: used by user=root, cwd unknown, recorded as (unknown:3005)
# Port 3007: used by docker-proxy (pid=1234, cwd=/home/user/my-project)
#
# Recorded 4 port(s) to allocations.
#
# ะกะพะฒะตั: ะะฐะฟัััะธัะต ั sudo ะดะปั ะฟะพะปะฝะพะน ะธะฝัะพัะผะฐัะธะธ ะพ ะฟัะพัะตััะฐั: sudo port-selector --scan
```

ะญัะพ ัะพะทะดะฐัั ะฐะปะปะพะบะฐัะธะธ ะดะปั ะทะฐะฝัััั ะฟะพััะพะฒ, ััะพะฑั `port-selector` ะฝะต ะฟััะฐะปัั ะธั ะฒัะดะตะปะธัั. ะัะปะธ ะดะปั ะฝะตะบะพัะพััั ะฟะพััะพะฒ ะฝะต ัะดะฐะปะพัั ะฟะพะปััะธัั ะฟะพะปะฝัั ะธะฝัะพัะผะฐัะธั ะพ ะฟัะพัะตััะต (ะฝะฐะฟัะธะผะตั, ะดะปั ะฟัะพัะตััะพะฒ root), ะฟัะพะณัะฐะผะผะฐ ะฟะพะบะฐะถะตั ัะตะบะพะผะตะฝะดะฐัะธั ะทะฐะฟัััะธัั ั sudo.

**ะัะธะผะตัะฐะฝะธะต:** ะะพััั, ะทะฐะฝัััะต root-ะฟัะพัะตััะฐะผะธ (ะฝะฐะฟัะธะผะตั, `docker-proxy`), ะผะพะณัั ะฝะต ะธะผะตัั ะดะพัััะฟะฝะพะน ะธะฝัะพัะผะฐัะธะธ ะพ ะฟัะพัะตััะต. ะขะฐะบะธะต ะฟะพััั ะฒัั ัะฐะฒะฝะพ ะทะฐะฟะธััะฒะฐัััั ั ะผะฐัะบะตัะพะผ `(unknown:PORT)` ะดะปั ะฟัะตะดะพัะฒัะฐัะตะฝะธั ะบะพะฝัะปะธะบัะพะฒ ะฟัะธ ะฒัะดะตะปะตะฝะธะธ.

### ะะฟัะตะดะตะปะตะฝะธะต ะดะธัะตะบัะพัะธะธ Docker-ะบะพะฝัะตะนะฝะตัะพะฒ

ะะพะณะดะฐ ะฟะพัั ะฟัะฑะปะธะบัะตััั ัะตัะตะท Docker, ัะพัั-ะฟัะพัะตัั โ `docker-proxy` ั ะฑะตัะฟะพะปะตะทะฝัะผ `cwd=/`. `port-selector` ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพะฟัะตะดะตะปัะตั ัะตะฐะปัะฝัั ะดะธัะตะบัะพัะธั ะฟัะพะตะบัะฐ:

```bash
port-selector --scan
# Port 3007: used by docker-proxy (pid=585980, cwd=/home/user/my-project)
#                                                  โ ะฟะพะปััะตะฝะพ ะธะท ะบะพะฝัะตะนะฝะตัะฐ
```

ะะปั ะพะฟัะตะดะตะปะตะฝะธั ะดะธัะตะบัะพัะธะธ ะธัะฟะพะปัะทัะตััั:
1. ะะตะนะฑะป `com.docker.compose.project.working_dir` (ะฟัะพะตะบัั docker-compose)
2. ะััะพัะฝะธะบ bind mount (fallback ะดะปั `docker run`)

**ะัะธะผะตัะฐะฝะธะต:** ะขัะตะฑัะตััั ะฝะฐะปะธัะธะต CLI `docker`.

### ะัะณัะผะตะฝัั ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ

```
port-selector [options]

Options:
  -h, --help        ะะพะบะฐะทะฐัั ัะฟัะฐะฒะบั
  -v, --version     ะะพะบะฐะทะฐัั ะฒะตััะธั
  -l, --list        ะะพะบะฐะทะฐัั ะฒัะต ะฐะปะปะพะบะฐัะธะธ ะฟะพััะพะฒ
  -c, --lock [PORT] ะะฐะฑะปะพะบะธัะพะฒะฐัั ะฟะพัั ะดะปั ัะตะบััะตะน ะดะธัะตะบัะพัะธะธ (ะธะปะธ ัะบะฐะทะฐะฝะฝัะน ะฟะพัั)
  -u, --unlock [PORT] ะะฐะทะฑะปะพะบะธัะพะฒะฐัั ะฟะพัั ะดะปั ัะตะบััะตะน ะดะธัะตะบัะพัะธะธ (ะธะปะธ ัะบะฐะทะฐะฝะฝัะน ะฟะพัั)
  --forget          ะฃะดะฐะปะธัั ะฐะปะปะพะบะฐัะธั ะดะปั ัะตะบััะตะน ะดะธัะตะบัะพัะธะธ
  --forget-all      ะฃะดะฐะปะธัั ะฒัะต ะฐะปะปะพะบะฐัะธะธ
  --scan            ะัะพัะบะฐะฝะธัะพะฒะฐัั ะฟะพััั ะธ ะทะฐะฟะธัะฐัั ะทะฐะฝัััะต ั ะธั ะดะธัะตะบัะพัะธัะผะธ
```

## ะะพะฝัะธะณััะฐัะธั

ะัะธ ะฟะตัะฒะพะผ ะทะฐะฟััะบะต ัะพะทะดะฐัััั ัะฐะนะป ะบะพะฝัะธะณััะฐัะธะธ:

**~/.config/port-selector/default.yaml**

```yaml
# ะะฐัะฐะปัะฝัะน ะฟะพัั ะดะธะฐะฟะฐะทะพะฝะฐ
portStart: 3000

# ะะพะฝะตัะฝัะน ะฟะพัั ะดะธะฐะฟะฐะทะพะฝะฐ
portEnd: 4000

# ะะตัะธะพะด ะทะฐะผะพัะพะทะบะธ ะฟะพััะฐ ะฟะพัะปะต ะฒัะดะฐัะธ (ะฒ ะผะธะฝััะฐั)
# ะะพัั ะฝะต ะฑัะดะตั ะฟะตัะตะธัะฟะพะปัะทะพะฒะฐะฝ ะฒ ัะตัะตะฝะธะต ััะพะณะพ ะฒัะตะผะตะฝะธ
# 0 = ะพัะบะปััะตะฝะพ, 1440 = 24 ัะฐัะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั)
freezePeriodMinutes: 1440

# ะะฒัะพะผะฐัะธัะตัะบะพะต ัะดะฐะปะตะฝะธะต ะฐะปะปะพะบะฐัะธะน ะฟะพัะปะต ัะบะฐะทะฐะฝะฝะพะณะพ ะฟะตัะธะพะดะฐ
# ะะพะดะดะตัะถะธะฒะฐะตั: 30d (ะดะฝะธ), 720h (ัะฐัั), 24h30m (ะบะพะผะฑะธะฝะธัะพะฒะฐะฝะฝัะน ัะพัะผะฐั)
# ะัััะฐั ัััะพะบะฐ ะธะปะธ "0" = ะพัะบะปััะตะฝะพ (ะฟะพ ัะผะพะปัะฐะฝะธั)
allocationTTL: 30d
```

### TTL ะฐะปะปะพะบะฐัะธะน

ะะพะณะดะฐ `allocationTTL` ัััะฐะฝะพะฒะปะตะฝ, ะฐะปะปะพะบะฐัะธะธ ััะฐััะต ัะบะฐะทะฐะฝะฝะพะณะพ ะฟะตัะธะพะดะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะดะฐะปััััั ะฟัะธ ะบะฐะถะดะพะผ ะทะฐะฟััะบะต. ะญัะพ ะฟัะตะดะพัะฒัะฐัะฐะตั ะฝะฐะบะพะฟะปะตะฝะธะต ัััะฐัะตะฒัะธั ะฐะปะปะพะบะฐัะธะน ะพั ัะดะฐะปัะฝะฝัั ะฟัะพะตะบัะพะฒ:

```yaml
allocationTTL: 30d  # ะะปะปะพะบะฐัะธะธ ะธััะตะบะฐัั ะฟะพัะปะต 30 ะดะฝะตะน ะฝะตะฐะบัะธะฒะฝะพััะธ
```

ะัะตะผะตะฝะฝะฐั ะผะตัะบะฐ ะพะฑะฝะพะฒะปัะตััั ะบะฐะถะดัะน ัะฐะท, ะบะพะณะดะฐ ะฟะพัั ะฒะพะทะฒัะฐัะฐะตััั ะดะปั ัััะตััะฒัััะตะน ะฐะปะปะพะบะฐัะธะธ, ะฟะพััะพะผั ะฐะบัะธะฒะฝะพ ะธัะฟะพะปัะทัะตะผัะต ะฐะปะปะพะบะฐัะธะธ ะฝะธะบะพะณะดะฐ ะฝะต ะธััะตะบะฐัั.

### ะะตัะธะพะด ะทะฐะผะพัะพะทะบะธ (Freeze Period)

ะะพัะปะต ะฒัะดะฐัะธ ะฟะพััะฐ ะพะฝ "ะทะฐะผะพัะฐะถะธะฒะฐะตััั" ะฝะฐ ัะบะฐะทะฐะฝะฝะพะต ะฒัะตะผั ะธ ะฝะต ะฑัะดะตั ะฒัะดะฐะฝ ะฟะพะฒัะพัะฝะพ. ะญัะพ ัะตัะฐะตั ะฟัะพะฑะปะตะผั, ะบะพะณะดะฐ ะฟัะธะปะพะถะตะฝะธะต ะผะตะดะปะตะฝะฝะพ ััะฐัััะตั ะธ ะฟะพัั ะบะฐะถะตััั ัะฒะพะฑะพะดะฝัะผ, ัะพัั ะฝะฐ ะฝัะผ ะฒะพั-ะฒะพั ะทะฐะฟัััะธััั ะดััะณะพะน ัะตัะฒะตั.

```
ะัะตะผั 10:00 - Agent 1 ะทะฐะฟัะพัะธะป ะฟะพัั โ ะฟะพะปััะธะป 3000
ะัะตะผั 10:01 - Agent 2 ะทะฐะฟัะพัะธะป ะฟะพัั โ ะฟะพะปััะธะป 3001 (3000 ะทะฐะผะพัะพะถะตะฝ)
ะัะตะผั 10:02 - Agent 1 ะพััะฐะฝะพะฒะธะปัั, ะฟะพัั 3000 ะพัะฒะพะฑะพะดะธะปัั
ะัะตะผั 10:03 - Agent 3 ะทะฐะฟัะพัะธะป ะฟะพัั โ ะฟะพะปััะธะป 3002 (3000 ะฒัั ะตัั ะทะฐะผะพัะพะถะตะฝ)
...
ะัะตะผั 34:01 - ะัะพัะปะพ 24 ัะฐัะฐ, ะฟะพัั 3000 ัะฐะทะผะพัะพะถะตะฝ
```

ะััะพัะธั ะฒัะดะฐะฝะฝัั ะฟะพััะพะฒ ััะฐะฝะธััั ะฒ `~/.config/port-selector/issued-ports.yaml` ะธ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพัะธัะฐะตััั ะพั ัััะฐัะตะฒัะธั ะทะฐะฟะธัะตะน.

### ะะตัะธัะพะฒะฐะฝะธะต

ะะปั ะพะฟัะธะผะธะทะฐัะธะธ ััะธะปะธัะฐ ะทะฐะฟะพะผะธะฝะฐะตั ะฟะพัะปะตะดะฝะธะน ะฒัะดะฐะฝะฝัะน ะฟะพัั ะฒ `~/.config/port-selector/last-used`. ะัะธ ัะปะตะดัััะตะผ ะฒัะทะพะฒะต ะฟัะพะฒะตัะบะฐ ะฝะฐัะธะฝะฐะตััั ั ััะพะณะพ ะฟะพััะฐ, ะฐ ะฝะต ั ะฝะฐัะฐะปะฐ ะดะธะฐะฟะฐะทะพะฝะฐ.

```
ะะตัะฒัะน ะฒัะทะพะฒ:  ะฟัะพะฒะตััะตั 3000 โ ัะฒะพะฑะพะดะตะฝ โ ะฒะพะทะฒัะฐัะฐะตั 3000, ัะพััะฐะฝัะตั 3000
ะัะพัะพะน ะฒัะทะพะฒ:  ะฟัะพะฒะตััะตั 3001 โ ัะฒะพะฑะพะดะตะฝ โ ะฒะพะทะฒัะฐัะฐะตั 3001, ัะพััะฐะฝัะตั 3001
ะขัะตัะธะน ะฒัะทะพะฒ:  ะฟัะพะฒะตััะตั 3002 โ ะทะฐะฝัั โ ะฟัะพะฒะตััะตั 3003 โ ัะฒะพะฑะพะดะตะฝ โ ะฒะพะทะฒัะฐัะฐะตั 3003
...
ะะพัะปะต 4000:    ะฟัะพะฒะตััะตั 3000 (wrap-around)
```

## ะะปะณะพัะธัะผ ัะฐะฑะพัั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          port-selector                 โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ
                   โ
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. ะงะธัะฐะตะผ ะบะพะฝัะธะณ                      โ
โ     ~/.config/port-selector/default.yamlโ
โ     (ัะพะทะดะฐัะผ ะตัะปะธ ะฝะตั)                 โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ
                   โ
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  2. ะงะธัะฐะตะผ last-used ะธ ะธััะพัะธั         โ
โ     last-used โ ะฝะฐัะฐะปัะฝะฐั ัะพัะบะฐ        โ
โ     issued-ports.yaml โ ะทะฐะผะพัะพะถะตะฝะฝัะต   โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ
                   โ
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  3. ะัะพะฒะตััะตะผ ะฟะพัั:                    โ
โ     - ะะต ะทะฐะผะพัะพะถะตะฝ?                    โ
โ     - ะะต ะทะฐะฑะปะพะบะธัะพะฒะฐะฝ ะดััะณะพะน ะดะธัะตะบั.?  โ
โ     - ะกะฒะพะฑะพะดะตะฝ? (net.Listen)           โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ
                   โ
           โโโโโโโโโดโโโโโโโโ
           โ               โ
      ะฟะพะดัะพะดะธั     ะทะฐะผะพัะพะถะตะฝ/ะทะฐะฝัั
           โ               โ
           โผ               โผ
โโโโโโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโโโโโ
โ 4a. ะกะพััะฐะฝัะตะผ:   โ โ 4b. ะกะปะตะดัััะธะน    โ
โ  - last-used     โ โ     ะฟะพัั         โ
โ  - ะฒ ะธััะพัะธั     โ โ     (wrap-around โ
โ  ะัะฒะพะดะธะผ STDOUT  โ โ     ะฟะพัะปะต ะบะพะฝัะฐ) โ
โโโโโโโโโโโโโโโโโโโโ โโโโโโโโโโฌโโโโโโโโโโ
                              โ
                    โโโโโโโโโโโดโโโโโโโโโโ
                    โ                   โ
              ะตััั ะตัั          ะฒัะต ะฟัะพะฒะตัะตะฝั
                    โ                   โ
                    โผ                   โผ
              โ ัะฐะณ 3          โโโโโโโโโโโโโโโโโโ
                               โ ะะจะะะะ ะฒ STDERRโ
                               โ exit code 1    โ
                               โโโโโโโโโโโโโโโโโโ
```

## ะะฐะทัะฐะฑะพัะบะฐ

### ะขัะตะฑะพะฒะฐะฝะธั

- Go 1.21+
- mise (ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะฒะตััะธัะผะธ)

### ะะพะบะฐะปัะฝะฐั ัะฑะพัะบะฐ

```bash
# ะฃััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ ัะตัะตะท mise
mise install

# ะะฐะฟัััะธัั ัะตััั
make test

# ะกะพะฑัะฐัั
make build

# ะกะพะฑัะฐัั ะธ ัััะฐะฝะพะฒะธัั ะฒ /usr/local/bin
make install

# ะฃะดะฐะปะธัั
make uninstall
```

### ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
port-selector/
โโโ cmd/
โ   โโโ port-selector/
โ       โโโ main.go          # ะขะพัะบะฐ ะฒัะพะดะฐ
โโโ internal/
โ   โโโ config/
โ   โ   โโโ config.go        # ะะฐะฑะพัะฐ ั ะบะพะฝัะธะณััะฐัะธะตะน
โ   โโโ cache/
โ   โ   โโโ cache.go         # ะะตัะธัะพะฒะฐะฝะธะต last-used
โ   โโโ docker/
โ   โ   โโโ docker.go        # ะะฟัะตะดะตะปะตะฝะธะต Docker-ะบะพะฝัะตะนะฝะตัะพะฒ
โ   โโโ history/
โ   โ   โโโ history.go       # ะััะพัะธั ะฒัะดะฐะฝะฝัั ะฟะพััะพะฒ (freeze period)
โ   โโโ port/
โ       โโโ checker.go       # ะัะพะฒะตัะบะฐ ะฟะพััะพะฒ
โโโ .github/
โ   โโโ workflows/
โ       โโโ release.yml      # GitHub Actions ะดะปั ัะตะปะธะทะพะฒ
โโโ .mise.toml               # ะะพะฝัะธะณััะฐัะธั mise
โโโ go.mod
โโโ go.sum
โโโ CLAUDE.md                # ะะฝััััะบัะธะธ ะดะปั AI-ะฐะณะตะฝัะพะฒ
โโโ README.md
```

## ะะธัะตะฝะทะธั

MIT

## ะะฒัะพั

[Danil Pismenny](https://pismenny.ru) ([@dapi](https://github.com/dapi))
